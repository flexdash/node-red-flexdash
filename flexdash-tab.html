<!-- FlexDash tab node for Node-RED
     Copyright Â©2022 by Thorsten von Eicken, see LICENSE
-->

<script type="text/javascript">

  RED.nodes.registerType('flexdash tab', {
    category: 'config',
    hasUsers: false, // prevent unused config node warning

    defaults: {
      name: { value: "" },
      icon: { value: "mdi-view-dashboard" },
      fd: { type:"flexdash dashboard", value:"", required:true }, // node id of dashboard
      fd_children: { value: "" }, // comma-separated list of child node IDs
    },

    label() {
      const i = this.icon && this.icon.replace(/^mdi-/, '')
      const name = this.name || i || (this.fd_pos != null ? `#${this.fd_pos+1}` : null)
      if (!name) return "New tab"
      const dash = this.fd?.title || ""
      return `Tab ${name} < Dash ${dash}`
    },

    oneditprepare() {
      const label = this.label || this._def.label // !@#$%^&* on create...
      $('#node-config-title').text(label.bind(this)())

      //flexdash.adjust_container_position('fd')
    },

    oneditsave() {
    },
  })
</script>

<script type="text/html" data-template-name="flexdash tab">
  <h3 id="node-config-title"></h3>
  <div class="form-row">
    <label for="node-config-input-name"><i class="icon-tag"></i> Name</label>
    <input type="text" id="node-config-input-name" placeholder="Name">
    <small class="fd-indent">Name shown in tab bar in dashboard. Leave Empty to only show icon.
    </small>
  </div>
  <div class="form-row">
    <label for="node-config-input-icon">Icon (material design icons)</span></label>
    <input type="text" id="node-config-input-icon" placeholder="mdi-airplane-takeoff" />
    <small class="fd-indent">Material design icon name to show in tab bar. Include the 'mdi-' prefix.
      See <a href="https://materialdesignicons.com">https://materialdesignicons.com</a>
    </small>
  </div>
  <div class="form-row">
    <label for="node-config-input-fd">Dashboard</label>
    <input type="text" id="node-config-input-fd">
    <small class="fd-indent">Dashboard to which this tab belongs.</small>
  </div>
  
  <!-- hidden fields -->
  <input type="hidden" id="node-config-input-fd_children">

</script>

<script type="text/html" data-help-name="flexdash tab">
  <p>Represents a tab in FlexDash</p>
</script>
